{% extends 'base.html' %}
{% load static %}
{% block title %}
    Stories
{% endblock title %}

{% block body %}
<style>
    .story-unviewed {
        border: 3px solid #0d6efd !important;
        box-shadow: 0 0 0 2px rgba(13, 110, 253, 0.5) !important;
    }
    .story-card {
        height: 300px;
        background-size: cover;
        background-position: center;
        position: relative;
    }
    .story-card-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(to bottom, rgba(0,0,0,0.1), rgba(0,0,0,0.7));
    }
</style>
    <div class="main-content right-chat-active">
        
        <div class="middle-sidebar-bottom">
            <div class="middle-sidebar-left pe-0">
                <div class="row">
                    <div class="col-xl-12">
                        <div class="card shadow-xss w-100 d-block d-flex border-0 p-4 mb-3">
                            <div class="card-body d-flex align-items-center p-0">
                                <h2 class="fw-700 mb-0 mt-0 font-md text-grey-900">Stories {{ user_stories|length }}</h2>
                            </div>
                        </div>

                        <div class="row ps-2 pe-1">
                            <div class="col-md-3 col-xss-6 pe-2 ps-2 mb-3">
                                <a href="{% url 'story:create_story' %}" class="card h300 d-block border-0 shadow-xss rounded-3 bg-dark overflow-hidden mb-3 text-center">
                                    <div class="card-body d-block w-100 position-absolute bottom-0 text-center">
                                        <span class="btn-round-lg bg-white"><i class="feather-plus font-lg"></i></span>
                                        <div class="clearfix"></div>
                                        <h4 class="fw-700 position-relative z-index-1 ls-1 font-xssss text-white mt-2 mb-1">Add Story</h4>
                                    </div>
                                </a>
                            </div>
                            {% for user, stories in user_stories.items %}
                                <div class="col-md-3 col-xss-6 pe-2 ps-2 mb-3">
                                    <a href="{% url 'story:view_story' stories.0.id %}" class="card story-card d-block border-0 shadow-xss rounded-3 overflow-hidden {% if not stories.0.is_viewed %}story-unviewed{% endif %}" 
                                        {% if stories.0.image %}
                                            style="background-image: url('{{ stories.0.image.url }}');"
                                        {% elif stories.0.video %}
                                            style="background-color: #000;"
                                        {% endif %}
                                    >
                                        <div class="story-card-overlay"></div>
                                        <div class="card-body d-block w-100 position-absolute bottom-0 text-center">
                                            <figure class="avatar ms-auto me-auto mb-0 position-relative w50 z-index-1">
                                                <img src="{{ user.img.url }}" alt="image" class="float-right p-0 bg-white rounded-circle w-100 shadow-xss">
                                            </figure>
                                            <div class="clearfix"></div>
                                            <h4 class="fw-600 position-relative z-index-1 ls-3 font-xssss text-white mt-2 mb-1">{{ user.username }}
                                                {% if user.verified %}
                                                    <i class="feather-check bg-success font-xs" style='border-radius:50px;'></i>
                                                {% endif %}
                                                {% if user.is_admin %}
                                                                                                                <i class="feather-check  font-xs" style='border-radius:50px; background-color: #FDD017'></i>

                                                {% endif %}
                                            </h4>
                                        </div>
                                        {% if stories.0.video %}
                                            <div class="video-icon position-absolute top-50 start-50 translate-middle">
                                                <i class="feather-play-circle text-white font-xl"></i>
                                            </div>
                                        {% endif %}
                                    </a>
                                </div>
                            {% endfor %}
                        </div>
                    </div>               
                </div>
            </div>
                
        </div>            
    </div>

{% endblock %}
